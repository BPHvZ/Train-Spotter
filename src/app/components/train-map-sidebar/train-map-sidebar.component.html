<!--
  ~ trainSpotter
  ~ Copyright (C) 2021 bart
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<div id="sidebar-wrapper" *ngIf="sidebarState$ | async as sidebarState">
	<div
		(@openClose-sidebar.start)="sidebarAnimationStarted($event)"
		(@openClose-sidebar.done)="sidebarAnimationFinished($event)"
		[@openClose-sidebar]="sidebarState"
		id="sidebar-container"
		class="mat-typography"
	>
		<div (click)="toggleSidebar()" class="frosted left-shadow" id="sidebar-arrow">
			<span [@rotatedState]="sidebarState" class="material-icons" style="margin-top: 85%; font-size: 26px">
				expand_more
			</span>
		</div>
		<div [@sidebar-shadow]="sidebarState" class="frosted" id="sidebar">
			<div class="container" id="sidebar-content">
				<div class="col">
					<div class="row justify-content-around" style="padding: 8px 0; align-items: center">
						<button (click)="toggleSidebar()" class="button button--close">
							<strong>&times;</strong>
						</button>
						<div *ngIf="disruptionsLastUpdated$ | async as date" class="text-center">
							<span style="font-size: small">Bijgewerkt op:<br /></span>
							{{ date | date: "EEEE d LLL HH:mm" }}
						</div>
						<button (click)="updateDisruptions.emit(null)" class="button button--nsYellow button--close">
							<strong><fa-icon [icon]="faSyncAlt" style="font-size: small"></fa-icon></strong>
						</button>
					</div>
					<div class="row">
						<div *ngIf="activeDisruptions">
							<div
								*ngFor="let disruption of activeDisruptions"
								[ngSwitch]="disruption.type"
								[ngClass]="{'disruption-cards--maintenance-border': disruption.type === 'MAINTENANCE'}"
								class="disruption-cards card card-max-width bg-light mb-3"
								tabindex="0"
							>
								<app-calamity-item
									[calamity]="disruption"
									*ngSwitchCase="'CALAMITY'"
								></app-calamity-item>
								<app-disruption-item
									tabindex="0"
									[disruption]="disruption"
									(mouseenter)="onMouseEnterDisruptionCard($event, disruption)"
									(mouseleave)="onMouseLeaveDisruptionCard($event, disruption)"
									(click)="flyToDisruption(disruption)"
									style="cursor: pointer"
									*ngSwitchDefault
								></app-disruption-item>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
