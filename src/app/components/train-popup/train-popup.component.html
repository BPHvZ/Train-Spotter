<!--
  ~ trainSpotter
  ~ Copyright (C) 2021 bart
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<div style="pointer-events: auto" *ngIf="trainInformation" class="mat-typography">
	<div id="mapPopup" class="flex-parent-inline flex-parent--center-cross flex-parent--column absolute bottom">
		<div
			class="mapPopupContent color-white shadow-darken10 round txt-s clip txt-truncate"
			style="width: fit-content"
		>
			<div class="container-fluid d-flex">
				<div class="row" style="justify-content: space-between">
					<div class="col">
						<div class="row d-flex justify-content-between" style="width: max-content">
							<h3 style="margin: unset">
								<strong>
									{{ trainInformation.trainDetails?.vervoerder }} {{ getTypeOfTrain() }} trein {{
									trainInformation.ritId }}
									<span
										*ngFor="
											let trainPart of trainInformation.trainDetails?.materieeldelen;
											let i = index
										"
									>
										<span *ngIf="trainPart.materieelnummer">
											<span *ngIf="i == 0; else other"> met {{ trainPart.materieelnummer }}</span>
											<ng-template #other
												>{{i == (trainInformation.trainDetails.materieeldelen.length - 1) ? 'en'
												: ','}} {{ trainPart.materieelnummer }}
											</ng-template>
										</span>
									</span>
								</strong>
							</h3>
							<button
								class="button button--nsYellow button--close"
								style="margin-left: 10px"
								(click)="closePopup.emit()"
							>
								<strong>&times;</strong>
							</button>
						</div>
						<div class="row" style="align-items: center">
							<span style="padding-right: 10px"
								>Snelheid: {{ trainInformation.snelheid | number:'1.0-2' }} km/u</span
							>
							<span class="material-icons" [ngStyle]="directionArrowStyle">arrow_right_alt</span>
							<span>{{ trainInformation.richting }}&deg;</span>
						</div>
						<div
							class="row"
							*ngIf="trainInformation.trainDetails?.materieeldelen && trainInformation.trainDetails?.materieeldelen[0]?.afbeelding"
						>
							<div id="carousel">
								<div
									class="slide"
									*ngFor="let railcar of trainInformation.trainDetails.materieeldelen; let isLast = last"
								>
									<img
										[src]="railcar.afbeelding"
										alt="Trein"
										height="45"
										[ngClass]="{ 'pr-2': isLast }"
									/>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<span class="flex-child triangle triangle--d" style="color: #00337f"></span>
	</div>
</div>
